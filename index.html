<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Steal Brain Rot Completo</title>
<style>
body {margin:0; padding:0; background:url('stealfondo.png') no-repeat center center fixed; background-size: cover; font-family: Arial,sans-serif; overflow:hidden;}
#monedas {position:fixed; top:20px; right:20px; font-size:32px; font-weight:bold; color:#ffff00; text-shadow:0 0 10px #ffff00,0 0 20px #ffff00; background: rgba(0,0,0,0.4); padding:10px 20px; border-radius:15px; z-index:1000; transition: all 0.5s ease;}
#monedas.animacion { transform: scale(1.3); box-shadow: 0 0 20px #ffff00; }
#musica-icono {position:fixed; top:90px; right:30px; width:40px; height:40px; cursor:pointer; z-index:1000; filter: drop-shadow(2px 2px 4px black);}
#personaje-container {position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); text-align:center;}
#personaje-frame {width:200px; height:200px; margin:auto; display:flex; align-items:center; justify-content:center; background: rgba(0,0,0,0.3); border-radius:20px; overflow:hidden;}
#personaje-img {max-width:100%; max-height:100%; opacity:0; transform:scale(0.8); transition:all 0.8s ease;}
#personaje-img.mostrar {opacity:1; transform:scale(1);}
.boton-comprar, .boton-robar, .boton-bloqueo {margin-top:5px; cursor:pointer; padding:10px 16px; font-size:16px; font-weight:bold; color:white; background: linear-gradient(135deg,#ff6a00,#ffb347); border:none; border-radius:15px; box-shadow:0 4px 12px rgba(0,0,0,0.4); transition: transform 0.2s ease, box-shadow 0.2s ease;}
.boton-comprar:hover, .boton-robar:hover, .boton-bloqueo:hover {transform:scale(1.1); box-shadow:0 6px 18px rgba(0,0,0,0.6);}
#valor-personaje {margin-top:5px; font-size:16px; font-weight:bold; color:#00ff00;}
#produccion {margin-top:5px; font-size:16px; font-weight:bold; color:yellow; text-shadow:2px 2px 6px black;}
#mensaje {position:fixed; bottom:20px; left:50%; transform:translateX(-50%); background: rgba(0,0,0,0.7); color:white; padding:8px 16px; border-radius:10px; display:none; font-size:16px; min-width:180px; text-align:center;}
#base-btn {position:fixed; bottom:20px; left:20px; padding:10px 14px; font-size:14px; font-weight:bold; color:white; background: linear-gradient(135deg,#00c6ff,#0072ff); border:none; border-radius:15px; box-shadow:0 4px 12px rgba(0,0,0,0.4); cursor:pointer; z-index:1000;}
#base-btn:hover {transform:scale(1.05); box-shadow:0 6px 18px rgba(0,0,0,0.6);}
#panel-base {position:fixed; bottom:70px; left:20px; width:80%; max-width:350px; max-height:400px; overflow-y:auto; background: rgba(0,0,0,0.8); color:white; border-radius:15px; padding:15px; display:none; z-index:999;}
#panel-base h2 {margin-top:0; text-align:center; color:#ffd700;}
#contador-bloqueo {color:red; font-weight:bold; text-align:center; margin-top:5px;}
.personaje-item {display:flex; align-items:center; justify-content:space-between; margin:5px; width:100%; border-bottom:1px solid #fff; padding:5px;}
.personaje-item img {width:50px; height:50px; object-fit:contain;}
#comprar-plazas {margin-top:10px; padding:8px; background:#28a745; color:white; font-weight:bold; border:none; border-radius:10px; cursor:pointer; width:100%; text-align:center;}
.bases-exteriores {position:fixed; left:10px; display:flex; flex-direction:column; gap:10px; top:150px; z-index:1000;}
.bases-exteriores button {padding:12px; background:red; color:white; font-weight:bold; font-size:14px; border:none; border-radius:10px; cursor:pointer; width:100px;}
#x-cerrar-externa {position:fixed; bottom:10px; right:10px; font-size:30px; color:red; cursor:pointer; display:none; z-index:2000;}
#x-robo {position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); font-size:100px; color:red; display:none; z-index:2000;}
#personaje-robo {position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); width:200px; height:200px; display:none; z-index:2000;}
#detener-robo {position:fixed; bottom:20px; left:50%; transform:translateX(-50%); display:none; padding:10px 16px; font-weight:bold; color:white; background:red; border:none; border-radius:12px; cursor:pointer; z-index:2001;}
#panel-externa {position:fixed; top:50px; right:20px; width:250px; max-height:400px; overflow-y:auto; background: rgba(0,0,0,0.8); color:white; border-radius:15px; padding:15px; display:none; z-index:1000;}
#panel-externa h3 {text-align:center; color:#ffd700;}
.personaje-externa {display:flex; align-items:center; justify-content:space-between; margin:5px; border-bottom:1px solid #fff; padding:5px;}
.personaje-externa img {width:40px; height:40px;}
.circulo-rojo {position:absolute; width:30px; height:30px; border-radius:50%; background:red; cursor:pointer; z-index:3000;}
@media(max-width:600px){
  #personaje-frame {width:150px; height:150px;}
  .boton-comprar, .boton-robar {font-size:14px; padding:8px 12px;}
  #monedas {font-size:24px; padding:6px 12px;}
  .bases-exteriores button {width:80px; font-size:12px; padding:8px;}
  #personaje-robo {width:150px;height:150px;}
  #panel-externa {width:200px;}
}
</style>
</head>
<body>
<div id="monedas">10,000</div>
<img id="musica-icono" src="musica_off.png" alt="Música">
<div id="personaje-container">
  <div id="personaje-frame">
    <img id="personaje-img" src="personaje1.png" alt="">
  </div>
  <div id="valor-personaje">Valor: 0</div>
  <button class="boton-comprar" id="comprar-btn">Comprar</button>
  <div id="produccion">+0/seg</div>
</div>
<div id="mensaje"></div>
<button id="base-btn">Mi Base</button>
<div id="panel-base">
  <h2>Mi Base</h2>
  <button class="boton-bloqueo" id="bloqueo-btn">Abrir/Cerrar Base</button>
  <div id="contador-bloqueo"></div>
  <div id="lista-personajes"></div>
  <button id="comprar-plazas">Comprar 10 plazas (500,000 monedas)</button>
</div>
<div class="bases-exteriores">
  <button data-index="0">Base 1</button>
  <button data-index="1">Base 2</button>
  <button data-index="2">Base 3</button>
</div>
<div id="panel-externa"><h3>Base Externa</h3><div id="lista-externa"></div></div>
<div id="x-cerrar-externa">X</div>
<img id="personaje-robo" src="" alt="">
<button id="detener-robo">Detener Robo</button>
<div id="x-robo">X</div>
<audio id="musica" src="musicabrainrots.mp3" loop></audio>
<audio id="sonido-compra" src="compra.mp3"></audio>
<audio id="sonido-comprafallida" src="comprafallida.mp3"></audio>
<audio id="sonido-clic" src="clic.mp3"></audio>
<audio id="sonido-cerrada" src="cerrada.mp3"></audio>
<audio id="sonido-robo" src="robodepersonaje.mp3"></audio>
<audio id="sonido-alerta" src="alerta.mp3"></audio>

<script>
// --- Variables ---
const personajes = {
"personaje1": {precio:300000, produccion:100}, "personaje2":{precio:200,produccion:10}, "personaje3":{precio:700000,produccion:900},
"personaje4":{precio:720000,produccion:950}, "personaje5":{precio:900000,produccion:1200}, "personaje6":{precio:1200000,produccion:2000},
"personaje7":{precio:400000,produccion:400}, "personaje8":{precio:2000000,produccion:20000}, "personaje9":{precio:20000000,produccion:100000},
"personaje10":{precio:70000000,produccion:400000}, "personaje11":{precio:20000,produccion:300}, "personaje12":{precio:30000000,produccion:1000000},
"personaje13":{precio:100000000,produccion:10000000}, "personaje14":{precio:500000000,produccion:40000000}, "personaje15":{precio:5000000,produccion:500000}
};
let monedas=10000, personajesComprados=[], personajeActual=null, produccionTotal=0;
let plazas=20, musicaActiva=false, bloqueoActivo=false, tiempoRestante=0;

const basesExternas = [
  {nombre:"Base 1", abierta:true, contador:0, personajes:[]},
  {nombre:"Base 2", abierta:true, contador:0, personajes:[]},
  {nombre:"Base 3", abierta:true, contador:0, personajes:[]},
];

const musica=document.getElementById("musica");
const musicaIcono=document.getElementById("musica-icono");
const sonidoCompra=document.getElementById("sonido-compra");
const sonidoCompraFallida=document.getElementById("sonido-comprafallida");
const sonidoCerrada=document.getElementById("sonido-cerrada");
const sonidoRobo=document.getElementById("sonido-robo");
const sonidoAlerta=document.getElementById("sonido-alerta");
const contadorMonedas=document.getElementById("monedas");
const contadorBloqueo=document.getElementById("contador-bloqueo");
const panelBase=document.getElementById("panel-base");
const listaExterna=document.getElementById("lista-externa");
const personajeRoboImg=document.getElementById("personaje-robo");
const detenerRoboBtn=document.getElementById("detener-robo");
const xRobo=document.getElementById("x-robo");
const xCerrarExterna=document.getElementById("x-cerrar-externa");

// --- Funciones, carga, guardar, actualizar ---
function cargarDatos(){
  const datos=JSON.parse(localStorage.getItem("datosJuego"))||{};
  monedas=datos.monedas||10000; personajesComprados=datos.personajesComprados||[];
  produccionTotal=datos.produccionTotal||0; plazas=datos.plazas||20;
  musicaActiva=datos.musicaActiva||false;
  actualizarMonedas(); actualizarPanel(); actualizarIconoMusica();
}
function guardarDatos(){ localStorage.setItem("datosJuego",JSON.stringify({monedas,personajesComprados,produccionTotal,plazas,musicaActiva})); }
function actualizarMonedas(animar=true){ contadorMonedas.textContent=monedas.toLocaleString(); if(animar){ contadorMonedas.classList.add("animacion"); setTimeout(()=>{ contadorMonedas.classList.remove("animacion"); },500); } }
function actualizarPanel(){ const lista=document.getElementById("lista-personajes"); lista.innerHTML=""; personajesComprados.forEach(p=>{ const div=document.createElement("div"); div.className="personaje-item"; const img=document.createElement("img"); img.src=p+".png"; div.appendChild(img); lista.appendChild(div); }); }
function mostrarMensaje(texto){ const msg=document.getElementById("mensaje"); msg.textContent=texto; msg.style.display="block"; setTimeout(()=>{ msg.style.display="none"; },3000); }
function actualizarIconoMusica(){ musicaIcono.src=musicaActiva?"musica_on.png":"musica_off.png"; }

// --- Música ---
musicaIcono.addEventListener("click",()=>{ if(musicaActiva){ musica.pause(); musicaActiva=false; } else { musica.play().catch(()=>{}); musicaActiva=true; } actualizarIconoMusica(); guardarDatos();});

// --- Cambio de personaje ---
function cambiarPersonaje(){
  const keys=Object.keys(personajes); let nuevo; do{ nuevo=keys[Math.floor(Math.random()*keys.length)]; }while(nuevo===personajeActual);
  personajeActual=nuevo;
  const img=document.getElementById("personaje-img"); img.classList.remove("mostrar");
  setTimeout(()=>{ img.src=`${personajeActual}.png`; img.classList.add("mostrar"); },100);
  document.getElementById("produccion").textContent=`+${personajes[nuevo].produccion.toLocaleString()}/seg`;
  document.getElementById("valor-personaje").textContent=`Valor: ${personajes[nuevo].precio.toLocaleString()} monedas`;
}
setInterval(cambiarPersonaje,5000);

// --- Compra ---
document.getElementById("comprar-btn").addEventListener("click",()=>{
  const data=personajes[personajeActual];
  if(personajesComprados.length>=plazas){ mostrarMensaje("No hay huecos ⚠️"); sonidoCompraFallida.play(); return; }
  if(monedas>=data.precio){ monedas-=data.precio; personajesComprados.push(personajeActual); produccionTotal+=data.produccion;
    actualizarMonedas(); guardarDatos(); actualizarPanel(); mostrarMensaje("¡Comprado! ✅"); sonidoCompra.play();
  }else{ mostrarMensaje("No tienes suficientes monedas ❌"); sonidoCompraFallida.play(); }
});

// --- Producción ---
setInterval(()=>{ if(produccionTotal>0){ monedas+=produccionTotal; actualizarMonedas(); guardarDatos(); } },1000);

// --- Base propia abrir/cerrar ---
document.getElementById("bloqueo-btn").addEventListener("click",()=>{
  if(!bloqueoActivo){ activarBloqueoBase(); } else{ desbloquearBase(); }
});
function activarBloqueoBase(){ bloqueoActivo=true; tiempoRestante=60; contadorBloqueo.textContent=`Base cerrada: ${tiempoRestante}s`; sonidoCerrada.play();
  const timer=setInterval(()=>{ tiempoRestante--; contadorBloqueo.textContent=`Base cerrada: ${tiempoRestante}s`; if(tiempoRestante<=0){ clearInterval(timer); desbloquearBase(); mostrarMensaje("Bloqueo terminado"); } },1000);
}
function desbloquearBase(){ bloqueoActivo=false; contadorBloqueo.textContent=""; }

// --- Panel base ---
document.getElementById("base-btn").addEventListener("click",()=>{ panelBase.style.display=(panelBase.style.display==="block")?"none":"block"; actualizarPanel(); });
document.getElementById("comprar-plazas").addEventListener("click",()=>{
  const precio=500000, cantidad=10;
  if(monedas>=precio){ monedas-=precio; plazas+=cantidad; actualizarMonedas(); guardarDatos(); mostrarMensaje(`¡Compraste ${cantidad} plazas! ✅`); sonidoCompra.play(); }
  else{ mostrarMensaje("No tienes monedas suficientes ❌"); sonidoCompraFallida.play(); }
});

// --- Bases externas ---
const botonesBases=document.querySelectorAll('.bases-exteriores button');
botonesBases.forEach(btn=>{ btn.addEventListener('click',()=>{ const index=parseInt(btn.getAttribute('data-index')); abrirPanelExterna(index); }); });
function abrirPanelExterna(index){
  const base=basesExternas[index]; const panel=document.getElementById("panel-externa");
  panel.style.display="block"; xCerrarExterna.style.display="block";
  const lista=document.getElementById("lista-externa"); lista.innerHTML="";
  const estado=base.abierta?"Abierta":"Cerrada ("+base.contador+"s)"; panel.querySelector("h3").textContent=`${base.nombre} - ${estado}`;
  base.personajes.forEach((p,idx)=>{
    const div=document.createElement("div"); div.className="personaje-externa";
    const img=document.createElement("img"); img.src=p+".png";
    const btnR=document.createElement("button"); btnR.textContent="Robar"; btnR.className="boton-robar";
    btnR.disabled=!base.abierta; btnR.addEventListener("click",()=>{ iniciarRoboExterno(base,idx); });
    div.appendChild(img); div.appendChild(btnR); lista.appendChild(div);
  });
}
xCerrarExterna.addEventListener("click",()=>{ document.getElementById("panel-externa").style.display="none"; xCerrarExterna.style.display="none"; });

// --- Simulación progresiva bases externas ---
setInterval(()=>{ basesExternas.forEach(base=>{
  if(base.contador>0){ base.contador--; } else{ base.abierta=Math.random()<0.5; base.contador=Math.floor(Math.random()*20+10); }
  if(base.personajes.length<15){ const keys=Object.keys(personajes); const p=keys[Math.floor(Math.random()*keys.length)]; base.personajes.push(p); }
}); },1000);

// --- Robo externo ---
function iniciarRoboExterno(base,idx){
  const p=base.personajes[idx]; mostrarMensaje(`Intentando robar... ⏳`);
  let tiempoRobo=10; const intervalo=setInterval(()=>{
    tiempoRobo--; if(tiempoRobo<=0){ clearInterval(intervalo);
      const valor=personajes[p].precio;
      const chance=Math.min(0.95,0.5+valor/100000000); if(Math.random()>chance){
        personajesComprados.push(p); produccionTotal+=personajes[p].produccion; actualizarPanel(); guardarDatos();
        mostrarMensaje("¡Robo exitoso! ✅"); sonidoCompra.play(); 
      }
      else{ mostrarMensaje("Robo fallido ❌"); sonidoCompraFallida.play(); }
    }
  },1000);
}

// --- Robo a nosotros ---
function intentoRoboANosotros(){
  if(bloqueoActivo || personajesComprados.length===0) return;
  const idx=Math.floor(Math.random()*personajesComprados.length);
  const p=personajesComprados[idx]; personajeRoboImg.src=p+".png"; personajeRoboImg.style.display="block"; sonidoAlerta.play();
  const totalCirculos=Math.min(10, Math.floor(personajes[p].precio/50000000)+1); let tocados=0;
  const circulos=[];
  for(let i=0;i<totalCirculos;i++){
    const c=document.createElement("div"); c.className="circulo-rojo"; c.style.top=Math.random()*window.innerHeight+"px"; c.style.left=Math.random()*window.innerWidth+"px";
    c.addEventListener("click",()=>{ c.remove(); tocados++; });
    document.body.appendChild(c); circulos.push(c);
  }
  let tiempoRobo=10; detenerRoboBtn.style.display="block";
  const interval=setInterval(()=>{
    tiempoRobo--;
    if(tiempoRobo<=0){ clearInterval(interval); personajeRoboImg.style.display="none"; detenerRoboBtn.style.display="none";
      circulos.forEach(c=>c.remove());
      if(tocados>=Math.ceil(totalCirculos/2)){ mostrarMensaje("¡Robo detenido! ✅"); sonidoCompra.play(); } 
      else{ mostrarMensaje("¡Nos han robado! ❌"); sonidoCompraFallida.play(); personajesComprados.splice(idx,1); actualizarPanel(); guardarDatos(); }
    }
  },1000);
}
detenerRoboBtn.addEventListener("click",()=>{ document.querySelectorAll('.circulo-rojo').forEach(c=>c.remove()); personajeRoboImg.style.display="none"; detenerRoboBtn.style.display="none"; mostrarMensaje("Robo detenido ✅"); sonidoCompra.play(); });

// --- Simulación robos aleatorios ---
setInterval(()=>{ if(Math.random()<0.02) intentoRoboANosotros(); },5000);

// --- Inicial ---
cargarDatos();
cambiarPersonaje();
</script>
</body>
</html>
